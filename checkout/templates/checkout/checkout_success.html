{% extends "base.html" %}
{% load static %}


{% block extra_css %}
    <link rel="stylesheet" href="{% static 'checkout/css/checkout.css' %}">
{% endblock extra_css %}

{% block page_header %}
    <div class="div header-container">
        <div class="row">
            <div class="col"></div>
        </div>
    </div>
{% endblock page_header%}

{% block content %}
    <div class="dc-background-overlay"></div>
    <div class="container">
        <!-- Shopping Checkout Success Header -->
        <div class="row">
            <div class="col-12">
                <h2 class="dc-logo-font">Thank You!</h2>
                <!-- HR Separator -->
                <div class="hr-heavy mb-5"></div>
                <p>Your order information is as shown below. A confirmation email will be sent to <strong>{{ order.email }}</strong> shortly.</p>
            </div>
        </div>

        <!-- Order Summary -->
        <div class="row">
            <div class="col-12 col-lg-8">
                <div class="container order-confirmation-wrapper p-2 border">

                    <!-- Order Info Header -->
                    <div class="row">
                        <div class="col">
                            <p class="text-small text-muted m-0 p-0">Order Information:</p>
                            <div class="hr-light"></div>
                        </div>
                    </div>

                    <!-- Order Number -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Order No:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.order_no }}</p>
                        </div>
                    </div>

                    <!-- order Date -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Order Date:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.order_date }}</p>
                        </div>
                    </div>

                    <!-- Order Details Header -->
                    <div class="row mt-4">
                        <div class="col">
                            <p class="text-small text-muted m-0 p-0">Order Details:</p>
                            <div class="hr-light"></div>
                        </div>
                    </div>

                    <!-- For each Order Line Item -->
                    {% for item in order.lineitems.all %}
                        <div class="row">
                            <div class="col-12 col-md-4">
                                <p class="text-small my-0 text-black">
                                    <strong>{{ item.product.item_id.name }}</strong>
                                </p>
                            </div>
                            <div class="col-12 col-md-8 text-md-right">
                                <p class="text-small my-0">Quantity: {{ item.quantity }} Total: €{{ item.lineitem_total | floatformat:2 }}</p>
                            </div>
                        </div>  
                    {% endfor %}

                    <!-- Delivering to heading: -->
                    <div class="row mt-4">
                        <div class="col">
                            <p class="text-small text-muted m-0 p-0">Delivering to:</p>
                            <div class="hr-light"></div>
                        </div>
                    </div>

                    <!-- Full Name -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Full Name:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.full_name }}</p>
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Email:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.email }}</p>
                        </div>
                    </div>

                    <!-- Phone Number -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Telephone:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.phone_no }}</p>
                        </div>
                    </div>

                    <!-- Street Address 1 -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Street Address 1:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.address_street_1 }}</p>
                        </div>
                    </div>

                    <!-- If Street Address 2 -->
                    {% if order.address_street_2 %}
                        <div class="row">
                            <div class="col-12 col-md-4">
                                <p class="my-0 text-black"><strong>Street Address 2:</strong></p>
                            </div>
                            <div class="col-12 col-md-8 text-md-right">
                                <p class="my-0">{{ order.address_street_2 }}</p>
                            </div>
                        </div>
                    {% endif %}

                    <!-- Town or City Name -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Town / City:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.address_town_city }}</p>
                        </div>
                    </div>

                    <!-- Postcode -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Postcode:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.address_postcode }}</p>
                        </div>
                    </div>

                    <!-- Country -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Country:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">{{ order.address_country }}</p>
                        </div>
                    </div>

                    <!-- Billing Info Header -->
                    <div class="row mt-4">
                        <div class="col">
                            <p class="text-small text-muted m-0 p-0">Billing Information:</p>
                            <div class="hr-light"></div>
                        </div>
                    </div>

                    <!-- Order Total -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Order Total:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">€ {{ order.order_total }}</p>
                        </div>
                    </div>

                    <!-- Delivery Cost -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Delivery:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">€ {{ order.delivery_cost }}</p>
                        </div>
                    </div>

                    <!-- Grand Total -->
                    <div class="row">
                        <div class="col-12 col-md-4">
                            <p class="my-0 text-black"><strong>Grand Total:</strong></p>
                        </div>
                        <div class="col-12 col-md-8 text-md-right">
                            <p class="my-0">€ {{ order.grand_total }}</p>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Return to Products Page Button -->
        <div class="text-end mt-5 mb-2">
            <!-- Back to products page button -->
            <a href="{% url 'products' %}" class="btn btn-dc-standard">
                <i class="bi bi-arrow-return-left"></i> Continue Shopping?
            </a>
        </div>
    </div>
    <!-- End Container -->
{% endblock content %}

{% block postload_js %}
    {{ black.super }}
    {{ stripe_public_key|json_script:"id_stripe_public_key" }}
    {{ client_secret|json_script:"id_client_secret" }}
    <script src="{% static 'checkout/js/stripe_elements.js' %}"></script> <!-- testhigh -->
{% endblock postload_js %}